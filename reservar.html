<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<title>Reservar ‚Äì COLESTUR</title>

<style>
  :root {
    --bg: #050508;
    --card: #0c0d11;
    --card-soft: #13141b;
    --accent: #3a7ce9;
    --accent-glow: rgba(58,124,233,.45);
    --text: #f4f6f9;
    --muted: #9ca3b5;
    --border: #1c1d25;
  }

  body {
    margin: 0;
    background: var(--bg);
    font-family: system-ui, -apple-system, sans-serif;
    color: var(--text);
  }

  header {
    padding: 16px;
    display: flex;
    align-items: center;
    gap: 12px;
    background: rgba(10,10,14,0.55);
    border-bottom: 1px solid #0e1015;
    position: sticky;
    top: 0;
    z-index: 50;
  }

  .logo-circle {
    width: 38px;
    height: 38px;
    border-radius: 999px;
    background: linear-gradient(135deg,#ffeaa7,#f1c40f);
    display:flex;
    justify-content:center;
    align-items:center;
    color:#111;
    font-weight:800;
  }

  main {
    padding: 20px 16px 140px;
    max-width: 780px;
    margin: auto;
  }

  .trip-card {
    background: var(--card);
    padding: 18px;
    border-radius: 18px;
    border: 1px solid var(--border);
    margin-bottom: 22px;
  }

  label {
    font-size: 12px;
    color: var(--muted);
    margin-bottom: 6px;
    display: block;
  }

  input, select {
    width: 100%;
    padding: 12px;
    border-radius: 14px;
    background: var(--card-soft);
    border: 1px solid var(--border);
    color: var(--text);
    font-size:14px;
  }

  #map {
    width: 100%;
    height: 300px;
    border-radius: 18px;
    border: 1px solid var(--border);
    margin-bottom: 8px;
  }

  .info-box {
    background: var(--card);
    border: 1px solid var(--border);
    padding: 16px;
    border-radius: 16px;
    margin-bottom: 20px;
  }

  .info-row {
    display:flex;
    justify-content:space-between;
    padding:8px 0;
    font-size: 15px;
  }

  .info-label {
    color: var(--muted);
  }

  /* BOT√ìN CONFIRMAR */
  .confirm-container {
    position: fixed;
    bottom: 70px;
    left: 0; right: 0;
    padding: 0 18px;
    z-index: 9999;
  }

  .btn-confirm {
    width: 100%;
    padding: 16px;
    background: var(--accent);
    color: white;
    font-weight: 700;
    font-size: 16px;
    border-radius: 999px;
    box-shadow: 0 12px 30px var(--accent-glow);
    border:none;
  }

  /* NAV BAR */
  .bottom-nav {
    position: fixed;
    bottom: 0; left: 0; right: 0;
    background:#0d0e12;
    border-top: 1px solid #1f2027;
    padding: 10px 0;
    display:flex;
    justify-content:space-around;
    z-index:99999;
  }

  .nav-item {
    text-align:center;
    font-size:14px;
    text-decoration:none;
    color:var(--muted);
  }

  .nav-item span {
    font-size: 22px;
    display:block;
  }

  .nav-active {
    color:white;
    font-weight:600;
  }
</style>
</head>

<body>

<header>
  <div class="logo-circle">CR</div>
  <div>
    <div style="font-size:12px;color:var(--muted)">TRANSPORTE ESPECIAL</div>
    <div style="font-size:18px;font-weight:700">COLESTUR S.A.S.</div>
  </div>
</header>

<main>

<section class="trip-card">
  <label>Punto de recogida</label>
  <input id="origen" placeholder="Cargando ubicaci√≥n‚Ä¶">

  <label style="margin-top:14px">Destino</label>
  <input id="destino" placeholder="¬øA d√≥nde vas?">
</section>

<div id="map"></div>

<div class="info-box">
  <div class="info-row">
    <span class="info-label">üìç Distancia:</span>
    <span id="distancia">‚Äî</span>
  </div>
  <div class="info-row">
    <span class="info-label">‚è± Tiempo estimado:</span>
    <span id="tiempo">‚Äî</span>
  </div>
</div>

<section class="trip-card">
  <label>Nombre completo</label>
  <input id="nombre">

  <label style="margin-top:12px;">WhatsApp</label>
  <input id="telefono" placeholder="57300‚Ä¶">

  <label style="margin-top:12px;">Servicio</label>
  <select id="servicio">
    <option>Escolar</option>
    <option>Empresarial</option>
    <option>Turismo</option>
    <option>Aeropuerto</option>
  </select>

  <label style="margin-top:12px;">Fecha</label>
  <input type="date" id="fecha">

  <label style="margin-top:12px;">Hora</label>
  <input type="time" id="hora">

  <label style="margin-top:12px;">Pasajeros</label>
  <input type="number" id="pasajeros" min="1" value="1">
</section>

<input type="hidden" id="origen_lat">
<input type="hidden" id="origen_lng">
<input type="hidden" id="destino_lat">
<input type="hidden" id="destino_lng">

</main>

<div class="confirm-container">
  <button id="btnReservar" class="btn-confirm">Confirmar reserva</button>
</div>

<div class="bottom-nav">
  <a href="index.html" class="nav-item"><span>üè†</span>Inicio</a>
  <a href="reservar.html" class="nav-item nav-active"><span>üöå</span>Reservar</a>
  <a href="contacto.html" class="nav-item"><span>üìû</span>Contacto</a>
</div>

<!-- ==================== GOOGLE MAPS ==================== -->
<script>
let map, originMarker, destMarker, directionsService, directionsRenderer;

function initMap() {

  directionsService = new google.maps.DirectionsService();
  directionsRenderer = new google.maps.DirectionsRenderer({
    suppressMarkers: true,
    polylineOptions:{ strokeColor:"#3a7ce9", strokeWeight:6 }
  });

  map = new google.maps.Map(document.getElementById("map"), {
    center:{lat:4.711,lng:-74.0721},
    zoom:14,
    disableDefaultUI:true
  });

  directionsRenderer.setMap(map);

  const geocoder = new google.maps.Geocoder();

  // ========= UBICACI√ìN REAL =========
  navigator.geolocation.getCurrentPosition(pos => {
    const lat = pos.coords.latitude;
    const lng = pos.coords.longitude;

    document.getElementById("origen_lat").value = lat;
    document.getElementById("origen_lng").value = lng;

    placeOriginMarker(lat,lng);
    map.setCenter({lat,lng});

    geocoder.geocode({location:{lat,lng}}, (res,status)=>{
      if(status==="OK" && res[0]){
        document.getElementById("origen").value = res[0].formatted_address;
      }
    });
  });

  // ========= AUTOCOMPLETE PRECISO =========
  const acOptions = {
    fields:["formatted_address","geometry","name"],
    types:["geocode"],
    componentRestrictions:{ country:"co" }
  };

  const acOrigen = new google.maps.places.Autocomplete(
    document.getElementById("origen"),
    acOptions
  );

  const acDestino = new google.maps.places.Autocomplete(
    document.getElementById("destino"),
    acOptions
  );

  acOrigen.addListener("place_changed",()=>{
    const p = acOrigen.getPlace();
    if(!p.geometry) return;

    document.getElementById("origen").value = p.formatted_address || p.name;
    document.getElementById("origen_lat").value = p.geometry.location.lat();
    document.getElementById("origen_lng").value = p.geometry.location.lng();

    placeOriginMarker(p.geometry.location.lat(), p.geometry.location.lng());
    calcularRuta();
  });

  acDestino.addListener("place_changed",()=>{
    const p = acDestino.getPlace();
    if(!p.geometry) return;

    document.getElementById("destino").value = p.formatted_address || p.name;
    document.getElementById("destino_lat").value = p.geometry.location.lat();
    document.getElementById("destino_lng").value = p.geometry.location.lng();

    placeDestinationMarker(p.geometry.location.lat(), p.geometry.location.lng());
    calcularRuta();
  });
}

function placeOriginMarker(lat,lng){
  if(!originMarker){
    originMarker = new google.maps.Marker({
      position:{lat,lng},
      map,
      icon:{
        path:google.maps.SymbolPath.CIRCLE,
        scale:8,
        fillColor:"#3a7ce9",
        fillOpacity:1,
        strokeColor:"#fff",
        strokeWeight:2
      }
    });
  } else originMarker.setPosition({lat,lng});
}

function placeDestinationMarker(lat,lng){
  if(!destMarker){
    destMarker = new google.maps.Marker({
      position:{lat,lng},
      map,
      icon:{
        path:"M 0 0 L 2 4 L 0 12 L -2 4 Z",
        fillColor:"#4bff8f",
        fillOpacity:1
      }
    });
  } else destMarker.setPosition({lat,lng});
}

function calcularRuta(){
  const oLat = parseFloat(document.getElementById("origen_lat").value);
  const oLng = parseFloat(document.getElementById("origen_lng").value);
  const dLat = parseFloat(document.getElementById("destino_lat").value);
  const dLng = parseFloat(document.getElementById("destino_lng").value);

  if(!oLat || !oLng || !dLat || !dLng) return;

  directionsService.route(
    {
      origin:{lat:oLat,lng:oLng},
      destination:{lat:dLat,lng:dLng},
      travelMode:"DRIVING",
      drivingOptions:{
        departureTime: new Date(),
        trafficModel:"best_guess"
      }
    },
    (res,status)=>{
      if(status==="OK"){
        directionsRenderer.setDirections(res);

        const leg = res.routes[0].legs[0];
        document.getElementById("distancia").textContent = leg.distance.text;
        document.getElementById("tiempo").textContent = leg.duration_in_traffic.text;
      }
    }
  );
}

window.initMap = initMap;
</script>

<script src="https://maps.googleapis.com/maps/api/js?key=AIzaSyD32zkRd46s5jKHkTjj2868WOMfv7m_V48&libraries=places&callback=initMap" async defer></script>

</body>
</html>
